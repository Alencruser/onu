<%-include('partials/header.ejs')%>
<% if(locals.roomId) { %>
<title>Room <%=roomId%></title>
</head>

<body id="tableGame" class="container-fluid">
    <div class="row" style="height:20%;">
        <div class="text-white col-lg-2 img-socket  offset-lg-1 text-center" id="siege6" data-socket="8"></div>
        <div class="text-white col-lg-2 img-socket text-center" id="siege7" data-socket="5,7"></div>
        <div class="text-white col-lg-2 img-socket text-center" id="siege8" data-socket="2,4,6,8"></div>
        <div class="text-white col-lg-2 img-socket text-center" id="siege9" data-socket="5,7"></div>
        <div class="text-white col-lg-2 img-socket text-center" id="siege10" data-socket="8"></div>
    </div>
    <div class="row" style="height:20%;">
        <div class="text-white col-lg-2 img-socket offset-lg-1 text-center" id="siege5" data-socket="3,6,7"></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 img-socket" id="siege11" data-socket="3,6,7"></div>
    </div> 
    <div class="row" style="height:20%;">
        <div class="text-white col-lg-2 img-socket offset-lg-1" id="siege4" data-socket="4,8"></div>
        <div class="text-white col-lg-6 text-center" id="discardedCard"></div>
        <div class="text-white col-lg-2 img-socket" id="siege12" data-socket="4,8"></div>
    </div>
    <div class="row" style="height:20%;">
        <div class="text-white col-lg-2 img-socket offset-lg-1" id="siege3" data-socket="5,6,7"></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 "></div>
        <div class="text-white col-lg-2 img-socket" id="siege13" data-socket="5,6,7"></div>
    </div>  
    <div class="row" style="height:20%;">
        <div class="text-white col-lg-2 img-socket offset-lg-1" id="siege2" data-socket="8"></div>
        <div class="text-white col-lg-6 text-center" stytle="z-index:9999" id="siege0" data-socket=""></div>
        <div class="text-white col-lg-2 img-socket" id="siege14" data-socket="8"></div>
    </div>


    <div class="modal fade" id="changeColor" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-body" id="colorContainer">
              <div class="color side" data-dismiss="modal" data-color="blue" style="background-color:blue"></div>
              <div class="color side" data-dismiss="modal" data-color="yellow" style="background-color:yellow"></div>
              <div class="color side" data-dismiss="modal" data-color="green" style="background-color:green"></div>
              <div class="color" data-dismiss="modal" data-color="red" style="background-color:red"></div>
            </div>
          </div>
        </div>
      </div>



</body>
<script>
    let socket = io('');

    let mypseudo = '<%=pseudo%>';
     
    setTimeout(()=>{
        connect()
    },200);
    function connect(){
        socket.emit('connect me', '<%=roomId%>','<%=pseudo%>');
    }

    socket.on('connect me', (players) => {
        if (players == '<%=number%>') {
            //message starting game 
            //eventt socket pour chercher les id, prendre un hote et start SA game
            socket.emit('start game','<%=price%>');
            console.log('tous les joueurs sont là, début de la partie')
        } else {
            //modifier les alertes custom pour tenir informés les joueurs du "chargement"
            console.log(players + ' joueurs présent sur <%=number%>');
        }
    });

    // document.onkeydown = fkey;
    // document.onkeypress = fkey
    // document.onkeyup = fkey;

    var wasPressed = false;

    function fkey(e){
        e = e || window.event;
       if( wasPressed ) return; 

        if (e.keyCode == 116) {
            window.location.href= window.location.href.replace('/room','');
            wasPressed = true;
        }
    }
</script>
<% } %>
<%-include('partials/footer.ejs')%>